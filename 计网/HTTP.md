# HTTPS
HTTP 有以下安全性问题：
- 使用明文进行通信，内容可能会被窃听；
- 不验证通信方的身份，通信方的身份有可能遭遇伪装；
- 无法证明报文的完整性，报文有可能遭篡改。

<font color=green>HTTPS其实就是将HTTP的数据包再通过SSL/TLS加密后传输</font>

SSL（Secure Sockets Layer）安全套接层和TLS（Transport Layer Security）传输层安全协议其实是一套东西。

## HTTPS工作流程
1. 用户在浏览器发起HTTPS请求，默认使用服务端的443端口进行连接；
2. 服务端收到请求，生成一对公私钥，去经过认证的CA机构申请颁发一份数字证书，数字证书里包含有证书持有者、证书有效期、服务器生成的公钥等信息。CA机构在颁发证书时会对证书明文信息进行哈希，然后使用CA机构的私钥进行加密，得到数字签名；
3. 服务端返回配置好的包含公钥Pub的证书给客户端；
4. 客户端收到证书，将证书分解成明文部分和数字签名，用操作系统或浏览器内置的CA机构的公钥进行解签，得到一个值A，再用证书里声明的哈希算法对明文进行哈希得到另一个值B，然后对比A和B，如果相等，则证明证书没有被篡改，然后再校验合法性，主要包括是否在有效期内、证书的域名与请求的域名是否匹配，上一级证书是否有效（递归判断，直到判断到系统内置或浏览器配置好的根证书），如果不通过，则显示HTTPS警告信息，如果通过则继续；
5. 客户端生成一个用于对称加密的随机Key，并用证书内的公钥Pub进行加密，发送给服务端；
6. 服务端收到随机Key的密文，使用与公钥Pub配对的私钥Private进行解密，得到客户端真正想发送的随机Key；
7. 服务端使用客户端发送过来的随机Key对要传输的HTTP数据进行对称加密，将密文返回客户端；
8. 客户端使用随机Key对称解密密文，得到HTTP数据明文；
9. 后续HTTPS请求使用之前交换好的随机Key进行对称加解密。